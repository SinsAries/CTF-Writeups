# WannaGame Freshman 2023 writeup
- Gi·∫£i WannaGame Freshman 2023 ƒë∆∞·ª£c t·ªï ch·ª©c b·ªüi Ph√≤ng th√≠ nghi·ªám An to√†n th√¥ng tin - UIT InSecLab
- Th·ªùi gian: ùüñùê°ùüéùüé - ùüèùüîùê°ùüéùüé, ng√†y ùüèùüè/ùüèùüè/ùüêùüéùüêùüë
- ƒê·ªãa ƒëi·ªÉm: Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá Th√¥ng tin ‚Äì ƒêHQG-HCM
# Th√¥ng tin t√°c gi·∫£
- H·ªç v√† t√™n: Nguy·ªÖn Tr·ªçng T·∫•t Th√†nh
- MSSV: 23521455
- Vai tr√≤: Cryptography
- Team: f1nd1ng_s0m3th1ng_g3nu1n3
# C√°c b√†i to√°n ƒë√£ gi·∫£i
## EasyRSA
>I gave you two hints! Now it's your turn to give me my flag.
>
>Flag format: W1{...}
>
>author: KienSD

**Attachments:**

[easyRSA.py](https://cnsc.uit.edu.vn/ctf/files/a234c27fa570fd45976f90122d743dee/easyRSA.py?token=eyJ1c2VyX2lkIjo4NjksInRlYW1faWQiOm51bGwsImZpbGVfaWQiOjE3NX0.ZVGI-w.sNv5YPTPoln_hPVVW8z-_wdeyao)
```
from Crypto.Util.number import bytes_to_long, getPrime

FLAG = b"W1{??????????????????????????}"

p = getPrime(512)
q = getPrime(512)
e = 65537

n = p*p*q*q

hint1 = p + q
hint2 = p*q - p - q + 1

print("c =", pow(bytes_to_long(FLAG),e,n))
print("hint 1:", hint1)
print("hint 2:", hint2)
```
[outputRSA.txt](https://cnsc.uit.edu.vn/ctf/files/05c93c6a4064ed807f236a4cc5596cc2/outputRSA.txt?token=eyJ1c2VyX2lkIjo4NjksInRlYW1faWQiOm51bGwsImZpbGVfaWQiOjE3Nn0.ZVGI-w.nMuOlJb6yXA15i9E0onVgeRYQhE)
```
c = 3778334964020085693122279865085669931544565594340822345918989508952697153279656102136896766069941711654206670695651429514092145744418890327941850114654449578138707810321552701030453820757236624767312202504750622959336960778419511800007797894081002357542180182105523582777650174695635469165347460411204007947912540366848738081190639561262267609709489546444644666346330477076696996699487362844232320060737648554287501932392681294728341607571792807384910146769288304726543715115373869342606973465866039825063286085254744403580981503955159533367921918990386586002820616696289107796591370087382822623875066545105848859819
hint 1: 20978135329472294939914714948198369484813382661367102444419294293577936274622454399412643333395069230540445488817871514639266385242274229865025904807357796
hint 2: 107283957759499663953333972940428532630825517639279168870550288698510570747194633174133941850038669632558664539532901591228896545932212704369190692506696118889217688783240077805671896860608066777266155415930965012190554894872594664088620308010376579887314084964024069034816205917207469185957050769629280580688
```

**Nh·∫≠n x√©t:**

- Sau khi ph√¢n t√≠ch m√£ ngu·ªìn ta c√≥ c√°c th√¥ng tin sau:
  - $p, q$ l√† 2 s·ªë nguy√™n t·ªë sinh ng·∫´u nhi√™n
  - $n = p^2 * q^2$
  - $e = 65537$
  - $hint1 = p + q$
  - $hint2 = pq - p - q + 1$

- T·ª´ nh·ªØng g√¨ ƒë·ªÅ cho m√¨nh suy ra:
  - $pq = hint2 + hint1 - 1$
    
- C√≥ th·ªÉ th·∫•y ƒë√¢y l√† 1 b√†i RSA c∆° b·∫£n, ta c√≥:

  -  $\varphi(n) = \varphi(p^2 * q^2)$

    $= p(p - 1)q(q - 1)$
  
    $= pq(pq - p - q + 1)$

    $= pq(pq - hint1 + 1)$

  -  $d = e$<sup>‚àí1</sup> $mod$ $\varphi(n)$
- T√¨m ƒë∆∞·ª£c d r·ªìi thi ta d·ªÖ d√†ng t√≠nh ƒë∆∞·ª£c $flag$ v·ªõi c√¥ng th·ª©c:

    $flag =$ $c^d$ $mod$ $n$

**Code(Python):**
```
from Crypto.Util.number import long_to_bytes as ltb

c = 3778334964020085693122279865085669931544565594340822345918989508952697153279656102136896766069941711654206670695651429514092145744418890327941850114654449578138707810321552701030453820757236624767312202504750622959336960778419511800007797894081002357542180182105523582777650174695635469165347460411204007947912540366848738081190639561262267609709489546444644666346330477076696996699487362844232320060737648554287501932392681294728341607571792807384910146769288304726543715115373869342606973465866039825063286085254744403580981503955159533367921918990386586002820616696289107796591370087382822623875066545105848859819
hint1 = 20978135329472294939914714948198369484813382661367102444419294293577936274622454399412643333395069230540445488817871514639266385242274229865025904807357796
hint2 = 107283957759499663953333972940428532630825517639279168870550288698510570747194633174133941850038669632558664539532901591228896545932212704369190692506696118889217688783240077805671896860608066777266155415930965012190554894872594664088620308010376579887314084964024069034816205917207469185957050769629280580688

pq = hint2 + hint1 - 1
n = pq*pq
e = 65537
phi = pq*(pq - hint1 + 1)
d = pow(e, -1, phi)
flag = pow(c, d, n)

print(ltb(flag))
#W1{0k_th1s_1s_e4sy_RSA_1nd33d}
```
