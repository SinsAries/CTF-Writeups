from Crypto.Util.number import *
from secret import flag, gen_safe_prime



def gen_pub_key(prime, difficulty):
    #Apparently it will be so easy if the modulus is a prime power so imma change it to composite >:)
    p = prime-1
    return p**difficulty


BITS = 1024
e = gen_safe_prime(BITS) #credit to my super secure prime generation algorithm
n = gen_pub_key(e, 3)
c = pow(e, flag, n)



print(f"{n = }")
print(f"{e = }")
print(f"{c = }")


"""
n = 9626912030792174837089280258600102740074144565313609606856956447057292779760707486627439638031093898990359642579611801405976623349846447818354157911542406757178599107040847977879312092464037129719361539094583081643357907227250023310497470562651187174411256422894281517811682729191241141797862452302734157208894850120830774047887099622082036102101344195960471265155472900400161582226293806547521104323716214780313931496782479659929046188019980280886144855942348737152435792403865442462858560013668776243793183442302112720510259225740921966440786154573056415759976657141060588068779877664201690594106348006004654643492524995296530321997319269464291899585873947032984194667679929953742382649595617645473317569811490649341196703964294962656746219906291929144447944304463077353788213169461273798377058867184491126881846240770702771063896701868026005619983810052696252492896946768866511659524299059937779630525251707259037171312232
e = 212730127851272469598164524775254842917085564506368105794827052954967711862616952670426149110511386835842600684124719661140008505076412114619966237126102296510748842334414280131533533748048613866538037089578702536019693871135293320231491614582238717425627700779733348523273997375657274362175801227064022666219
c = 2306491750678864267321670404655622235699701190732922071734855944947067225444098611132475216598648012618954183627035527625981975714037956389745244131776123611601273827028740891300134473540377593798686736004577855876744131929409065637981469626958302527783283082829190311942693426367708128098887636048271252795058327800884368566009935696146959018798725163585284608759688125143304490409202502889585890995939122882495885388630679916494369239681571705087175099808753171161099525462602565304803714978355572028436998439262102409729076110593935485452145563593542450924849024171568070666431651350412419976455007653996132833205707677221718228579545152592360506378450040265204372393058466906835080727478402765911666587345248615812548476992324057249863566893229035932307974908845710699931
"""
